<!DOCTYPE html>
<html lang="en">
<style>

  body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: -webkit-linear-gradient(#eee, #dcfffa);
    margin: 0;
    display: flex;
    height: 100vh;
    display: flex;
    overflow: hidden;
  }

  .page-link {
    color: #00e;
    text-decoration: underline;
    cursor: pointer;
    display: inline-block;
    padding: 5px 10px;
    border-radius: 5px;
    transition: background 0.5s ease-in-out;
  }

  .page-link:hover {
    background: rgba(0, 104, 138, 0.1);
  }
</style>
<head>
  <meta charset="UTF-8">
  <title>Example paper fixer</title>
</head>
<body style="margin: 0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.10.38/pdf.min.mjs" type="module"></script>
<iframe id="pdf-js-viewer" src="/static/pdfjs-4/web/viewer.html?file=/static/L24fullnotesp2.pdf" title="webviewer" frameborder="0" style="width:50%;height:100vh"></iframe>
<div style="display: inline-block; width:50%; float:right; padding-left: 5em; overflow-y: scroll; box-sizing: border-box; height:100vh;">
  <form id="upload-form" enctype="multipart/form-data">
    <label for="file">Choose a file:</label>
    <input type="file" name="file" id="file" required>
    <br><br>
    <input type="submit" value="Upload File">
  </form>

  <span id="question-place"></span>
</div>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript">
  let form = document.getElementById("upload-form");

  function generate_stuff(event) {
    event.preventDefault()
    fetch('/generate', {
      method: 'POST',
      body: new FormData(form)
    }).then(response => response.text())
            .then(response => {
      console.log(response)
      document.getElementById("question-place").innerHTML = response
    });
  }
  form.addEventListener('submit', generate_stuff)
</script>
<script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<script>
  function scrollToPDFPage(pageNumber) {
    let viewer = document.getElementById("pdf-js-viewer").contentWindow;
    function tryScroll() {
      if (viewer.PDFViewerApplication && viewer.PDFViewerApplication.pdfViewer) {
        let pdfViewer = viewer.PDFViewerApplication.pdfViewer;
        let page = pdfViewer._pages[pageNumber];

        if (page) {
          pdfViewer.container.scrollTo({
            top: page.div.offsetTop +2,
            behavior: "smooth"
          });
        }
      } else {
        setTimeout(tryScroll, 500);
      }
    }
    tryScroll();
  }
</script>
<script>
  function createVideoElement(videoUrl) {
    // Create video element
    let video = document.createElement('video');
    video.width = 320;
    video.height = 240;
    video.controls = true;

    // Create source element
    let source = document.createElement('source');
    source.src = videoUrl;
    source.type = 'video/mp4';

    // Append source to video
    video.appendChild(source);

    // Append video to the body or another container
    document.body.appendChild(video);
  }
</script>
<script>
  function createPopoutVideo(videoUrl) {
    // Calculate center position
    let width = 400;
    let height = 300;
    let left = (window.screen.width - width) / 2;
    let top = (window.screen.height - height) / 2;

    let popout = window.open("", "VideoPlayer", `width=${width},height=${height},top=${top},left=${left}`);
    if (!popout) {
      alert("Pop-up blocked! Please allow pop-ups for this site.");
      return;
    }

    // Write video element into the new window
    popout.document.write(`
      <html>
      <head>
          <title>Video Player</title>
      </head>
      <body style="margin:0; display:flex; justify-content:center; align-items:center; height:100vh; background-color:#000;">
          <video width="320" height="240" controls autoplay>
              <source src="${videoUrl}" type="video/mp4">
              Your browser does not support the video tag.
          </video>
      </body>
      </html>
  `);
  }
</script>
</body>
</html>
